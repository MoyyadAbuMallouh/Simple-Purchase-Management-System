2025-07-06 16:29:31.4927 ERROR PurchaseManagement.API.Services.AuthService Error during login for username: string Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'LastLoginAt'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at PurchaseManagement.API.Services.AuthService.LoginAsync(LoginRequestDto loginRequest) in D:\Anazeem_training\projects\Task1\PurchaseManagement.API\PurchaseManagement.API\Services\AuthService.cs:line 42
ClientConnectionId:60664c8c-4db7-4d36-b225-a4d77d0141e8
Error Number:207,State:1,Class:16
2025-07-06 16:29:44.2884 ERROR PurchaseManagement.API.Services.AuthService Error during login for username: moayyad Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'LastLoginAt'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at PurchaseManagement.API.Services.AuthService.LoginAsync(LoginRequestDto loginRequest) in D:\Anazeem_training\projects\Task1\PurchaseManagement.API\PurchaseManagement.API\Services\AuthService.cs:line 42
ClientConnectionId:60664c8c-4db7-4d36-b225-a4d77d0141e8
Error Number:207,State:1,Class:16
2025-07-06 16:32:47.2790 ERROR PurchaseManagement.API.Services.UserService Error fetching all users Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'LastLoginAt'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at PurchaseManagement.API.Services.UserService.GetAllUsersAsync() in D:\Anazeem_training\projects\Task1\PurchaseManagement.API\PurchaseManagement.API\Services\UserService.cs:line 260
ClientConnectionId:27c87e07-4be5-48ec-acd1-66b9a166ff0c
Error Number:207,State:1,Class:16
2025-07-06 16:32:47.3646 ERROR PurchaseManagement.API.Controllers.UsersController Error getting all users Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'LastLoginAt'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at PurchaseManagement.API.Services.UserService.GetAllUsersAsync() in D:\Anazeem_training\projects\Task1\PurchaseManagement.API\PurchaseManagement.API\Services\UserService.cs:line 260
   at PurchaseManagement.API.Controllers.UsersController.GetAllUsers() in D:\Anazeem_training\projects\Task1\PurchaseManagement.API\PurchaseManagement.API\Controllers\UsersController.cs:line 38
ClientConnectionId:27c87e07-4be5-48ec-acd1-66b9a166ff0c
Error Number:207,State:1,Class:16
2025-07-06 16:42:31.5209 ERROR PurchaseManagement.API.Services.AuthService Error during login for username: moayyad BCrypt.Net.SaltParseException: Invalid salt version
   at BCrypt.Net.BCrypt.HashPassword(String inputKey, String salt, Boolean enhancedEntropy, HashType hashType)
   at BCrypt.Net.BCrypt.Verify(String text, String hash, Boolean enhancedEntropy, HashType hashType)
   at PurchaseManagement.API.Services.AuthService.VerifyPassword(String password, String hash) in D:\Anazeem_training\projects\Task1\PurchaseManagement.API\PurchaseManagement.API\Services\AuthService.cs:line 199
   at PurchaseManagement.API.Services.AuthService.LoginAsync(LoginRequestDto loginRequest) in D:\Anazeem_training\projects\Task1\PurchaseManagement.API\PurchaseManagement.API\Services\AuthService.cs:line 52
2025-07-06 18:31:25.4028 ERROR PurchaseManagement.API.Services.UserService Error creating user: mallouh System.InvalidOperationException: Username already exists
   at PurchaseManagement.API.Services.UserService.CreateUserAsync(CreateUserDto createUserDto) in D:\Anazeem_training\projects\Task1\PurchaseManagement.API\PurchaseManagement.API\Services\UserService.cs:line 336
2025-07-06 19:20:55.5127 ERROR PurchaseManagement.API.Services.UserService Error toggling user status with ID: 2 System.InvalidOperationException: Cannot deactivate the last admin user
   at PurchaseManagement.API.Services.UserService.ToggleUserStatusAsync(Int32 id, Boolean isActive) in D:\Anazeem_training\projects\Task1\PurchaseManagement.API\PurchaseManagement.API\Services\UserService.cs:line 486
2025-07-06 19:45:41.8012 ERROR PurchaseManagement.API.Services.UserService Error creating user: moayyad System.InvalidOperationException: Username already exists
   at PurchaseManagement.API.Services.UserService.CreateUserAsync(CreateUserDto createUserDto) in D:\Anazeem_training\projects\Task1\PurchaseManagement.API\PurchaseManagement.API\Services\UserService.cs:line 336
